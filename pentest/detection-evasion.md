# detection evasion

## Collections

Antivirus/EDR evasion

* [wavestone-cdt/EDRSandblast - a tool written in C that weaponize a vulnerable signed driver to bypass EDR detections (Kernel callbacks and ETW TI provider) and LSASS protections. Multiple userland unhooking techniques are also implemented to evade userland monitoring](https://github.com/wavestone-cdt/EDRSandblast)
* [aaaddress1/Skrull - a malware DRM, that prevents Automatic Sample Submission by AV/EDR and Signature Scanning from Kernel. It generates launchers that can run malware on the victim using the Process Ghosting technique. Also, launchers are totally anti-copy and naturally broken when got submitted](https://github.com/aaaddress1/Skrull)
* [tanc7/EXOCET-AV-Evasion - AV-evading, undetectable, payload delivery tool](https://github.com/tanc7/EXOCET-AV-Evasion)
* [waldo-irc/LockdExeDemo - hook sleep函数，sleep时挂起所有其他线程，加密堆上分配的内存](https://github.com/waldo-irc/LockdExeDemo)
  * https://www.cyberark.com/resources/threat-research-blog/hook-heaps-and-live-free
* [mgeeky/ThreadStackSpoofer - Thread Stack Spoofing - PoC for an advanced In-Memory evasion technique allowing to better hide injected shellcode's memory allocation from scanners and analysts - 跟上面的手段类似](https://github.com/mgeeky/ThreadStackSpoofer)
* [last-byte/unDefender - Killing your preferred antimalware by abusing native symbolic links and NT paths - 启动TrustedInstaller服务，使用NtImpersonateThread切换token后，关闭WdFilter服务，之后利用软连接让Defender服务加载错误的驱动，实现杀软的关闭](https://github.com/last-byte/unDefender)
* [klezVirus/inceptor - Template-Driven AV/EDR Evasion Framework](https://github.com/klezVirus/inceptor)
* [bats3c/DarkLoadLibrary - LoadLibrary for offensive operations - 手动加载DLL，绕过内核ImageLoadCallbackRoutine监控](https://github.com/bats3c/DarkLoadLibrary)
* [timwhitez/Doge-Assembly - Golang evasion tool, execute-assembly .Net file - DLL unhook/ETW禁用/blockdlls/父进程修改等等](https://github.com/timwhitez/Doge-Assembly)
* [Airboi/bypass-av-note - 免杀技术大杂烩---乱拳也打不死老师傅](https://github.com/Airboi/bypass-av-note)
* [persianhydra/Xeexe-TopAntivirusEvasion - Undetectable & Xor encrypting with custom KEY (FUD Metasploit Rat) bypass Top Antivirus like BitDefender,Malwarebytes,Avast,ESET-NOD32,AVG,... & Automatically Add ICON and MANIFEST to excitable](https://github.com/persianhydra/Xeexe-TopAntivirusEvasion)
* [Mr-Un1k0d3r/EDRs - information about EDRs that can be useful during red team exercise - 通过判断第一个指令是否为JMP来检查函数是否被Hook，并给出了多个EDR的hook列表](https://github.com/Mr-Un1k0d3r/EDRs)
* [s3cur3th1ssh1t: A tale of EDR bypass methods](https://s3cur3th1ssh1t.github.io/A-tale-of-EDR-bypass-methods/)
* [gist: theevilbit/divide_and_conquer.c - Divide and Conquer NextGen AV bypass - 方法太low了，无实战价值](https://gist.github.com/theevilbit/073ca4eb15383eb3254272fc24632efd)
* [gnxbr/Fully-Undetectable-Techniques - I will post here my research aiming Fully UnDetectable (FUD) techniques and tools - 大多是基于CreateDesktop的](https://github.com/gnxbr/Fully-Undetectable-Techniques)
* [D3VI5H4/Antivirus-Artifacts - Anti-virus artifacts. Listing APIs hooked by: Avira, BitDefender, F-Secure, MalwareBytes, Norton, TrendMicro, and WebRoot](https://github.com/D3VI5H4/Antivirus-Artifacts)
* [outflanknl/TamperETW - selectively forward .NET ETW events](https://github.com/outflanknl/TamperETW)
* [matterpreter/SHAPESHIFTER - 通过syscall绕过hook](https://github.com/matterpreter/SHAPESHIFTER)
* [jthuraisamy/TelemetrySourcerer - Enumerate and disable common sources of telemetry used by AV/EDR - 用驱动删除AV的回调和钩子](https://github.com/jthuraisamy/TelemetrySourcerer)
* [br-sn/CheekyBlinder - Enumerating and removing kernel callbacks using signed vulnerable drivers](https://github.com/br-sn/CheekyBlinder)
* [ayoul3/reflect-pe - Reflectively load PE - 带一个关键词替换功能](https://github.com/ayoul3/reflect-pe)
* [scrt/avcleaner - C/C++ source obfuscator for antivirus bypass](https://github.com/scrt/avcleaner)
* [CylanceVulnResearch/ReflectiveDLLRefresher - a standalone test harness for scanning the process's memory space and unhooking the currently loaded libraries，恢复AV钩子的](https://github.com/CylanceVulnResearch/ReflectiveDLLRefresher)
* [optiv/ScareCrow - Payload creation framework designed around EDR bypass - 也是从文件恢复钩子的方法](https://github.com/optiv/ScareCrow)
* [secretsquirrel/SigThief - Stealing Signatures and Making One Invalid Signature at a Time](https://github.com/secretsquirrel/SigThief)
* [Shellter - AV Evasion Artware](https://www.shellterproject.com/)
* [Hackplayers/Salsa-tools - ShellReverse TCP/UDP/ICMP/DNS/SSL/BINDTCP and AV bypass, AMSI patched](https://github.com/Hackplayers/Salsa-tools)
* [Ch0pin/AVIator - Antivirus evasion project](https://github.com/Ch0pin/AVIator)
* [Mr-Un1k0d3r/DKMC - DKMC - Dont kill my cat - Malicious payload evasion tool](https://github.com/Mr-Un1k0d3r/DKMC)
* [Mr-Un1k0d3r/UniByAv - a simple obfuscator that take raw shellcode and generate executable that are Anti-Virus friendly](https://github.com/Mr-Un1k0d3r/UniByAv)
* [silentsignal/av-breaking - Bare Knuckled AV Breaking](https://github.com/silentsignal/av-breaking)
* [AbedAlqaderSwedan1/ASWCrypter - An Bash&Python Script For Generating Payloads that Bypasses All Antivirus so far FUD](https://github.com/AbedAlqaderSwedan1/ASWCrypter)
* [securemode/DefenderKeys - Quick PowerShell script to extract any exclusions configured for Windows Defender](https://github.com/securemode/DefenderKeys)
* [rootm0s/Protectors - Obfuscator, Encryption, Junkcode, Anti-Debug, PE protection/modification](https://github.com/rootm0s/Protectors)
* [threatexpress/metatwin - a file resource cloner. Metadata, including digital signature, is extracted from one file and injected into another](https://github.com/threatexpress/metatwin)
* [Ekultek/Graffiti - A tool to generate obfuscated one liners to aid in penetration testing](https://github.com/Ekultek/Graffiti)
* [DiabloHorn/cliramdisk - A reduced functionality cli client for the imdisk ram disk driver](https://github.com/DiabloHorn/cliramdisk)
* [gist: mattifestation/ExpandDefenderSig.ps1 - Decompresses Windows Defender AV signatures for exploration purposes](https://gist.github.com/mattifestation/3af5a472e11b7e135273e71cb5fed866)
* [perturbed-platypus - EDR Is Coming; Hide yo Sh!t - 将payload存储到UEFI](https://github.com/perturbed-platypus)
* [AdrianVollmer/PowerHub - A web application to transfer PowerShell modules, executables, snippets and files while bypassing AV and application whitelisting - 支持EXE/PS1远程加载](https://github.com/AdrianVollmer/PowerHub)
* [TideSec/BypassAntiVirus - 远控免杀系列文章及配套工具，搜集汇总了互联网上的几十种免杀工具和免杀方法 - 没啥用，只记录](https://github.com/TideSec/BypassAntiVirus)
* [the-xentropy/xencrypt - A PowerShell script anti-virus evasion tool](https://github.com/the-xentropy/xencrypt)
* [DeEpinGh0st/AutoRemove - 利用PyautoGUI实现的对防病毒软件的自动化卸载](https://github.com/DeEpinGh0st/AutoRemove)
* [f-secure: Bypassing Windows Defender Runtime Scanning - 使用 PAGE_NOACCESS 防止AV扫描](https://labs.f-secure.com/blog/bypassing-windows-defender-runtime-scanning/)
* [Red Team Tactics: Hiding Windows Services - 通过SetServiceObjectSecurity修改权限实现隐藏，测试不影响服务启动。](https://www.sans.org/blog/red-team-tactics-hiding-windows-services/)

EDR Telemetry

* [gist: jthuraisamy/loaded_psp_drivers.cpp - Loaded Security Product Drivers](https://gist.github.com/jthuraisamy/4c4c751df09f83d3620013f5d370d3b9)
* [jthuraisamy/TelemetrySourcerer - Enumerate and disable common sources of telemetry used by AV/EDR.](https://github.com/jthuraisamy/TelemetrySourcerer)
* [carbonblack/cbapi - server_apis/proto/sensor_events.proto - CB通信内容，2017年的PB定义，仅供参考](https://github.com/carbonblack/cbapi/blob/master/server_apis/proto/sensor_events.proto)
* [microsoft: Understand the advanced hunting schema in Microsoft Defender for Endpoint](https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/advanced-hunting-schema-reference)
* [microsoft: Collect support logs in Microsoft Defender for Endpoint using live response - 原先的MDATPClientAnalyzer程序](https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/troubleshoot-collect-support-log)

Restriction/whitelist bypass

* [bohops/UltimateWDACBypassList - A centralized resource for previously documented WDAC bypass techniques](https://github.com/bohops/UltimateWDACBypassList)
* [Mr-Un1k0d3r/Windows-SignedBinary - bypass endpoint solution that block known "malicious" signed application such as "regsvr32.exe" - 生成HASH不同，但是有微软签名的程序。方法是随机修改几个字节，检查签名是否还有效](https://github.com/Mr-Un1k0d3r/Windows-SignedBinary)
* [rootm0s/WinPwnage - Elevate, UAC bypass, persistence, privilege escalation, dll hijack techniques](https://github.com/rootm0s/WinPwnage)
* [SafeBreach-Labs/BACE - Mapping of Binaries that allows Arbitrary Code Execution](https://github.com/SafeBreach-Labs/BACE)
* [GreatSCT/GreatSCT - an open source project to generate application white list bypasses](https://github.com/GreatSCT/GreatSCT)
* [infosecn1nja/MaliciousMacroMSBuild - Generates Malicious Macro and Execute Powershell or Shellcode via MSBuild Application Whitelisting Bypass](https://github.com/infosecn1nja/MaliciousMacroMSBuild)
* [Jumbo-WJB/windows_exec_ways](https://github.com/Jumbo-WJB/windows_exec_ways)
* [gist: All System32 DLL export functions that contain "RunDLL", an indicator that it's designed to run with rundll32.exe](https://gist.github.com/mattifestation/27af49ff6b9ee6bbb21e4443310f70f5)
* [rvrsh3ll/CPLResourceRunner - Run shellcode from resource](https://github.com/rvrsh3ll/CPLResourceRunner)
* [fireeye/DueDLLigence - Shellcode runner for all application whitelisting bypasses](https://github.com/fireeye/DueDLLigence)
* [Neo23x0/DLLRunner - a smart DLL execution script for malware analysis in sandbox systems](https://github.com/Neo23x0/DLLRunner)
* [bohops/GhostBuild - a collection of simple MSBuild launchers for various GhostPack/.NET projects](https://github.com/bohops/GhostBuild)
* [outflanknl/NetshHelperBeacon - Example DLL to load from Windows NetShell - 没啥用](https://github.com/outflanknl/NetshHelperBeacon)
* [cyberark/Evasor - A tool to be used in post exploitation phase for blue and red teams to bypass APPLICATIONCONTROL policies](https://github.com/cyberark/Evasor)
* [trustedsec/auto_SettingContent-ms - a quick POC for using the Matt Nelson (enigma0x3) technique for generating a malicious .SettingContent-ms extension type for remote code execution - 执行方法与HTA一致](https://github.com/trustedsec/auto_SettingContent-ms)
* [jpginc/xbapAppWhitelistBypassPOC - A POC application whitelisting XBAP project](https://github.com/jpginc/xbapAppWhitelistBypassPOC)
* Powershell
  * [p3nt4/PowerShdll - Run PowerShell with rundll32. Bypass software restrictions](https://github.com/p3nt4/PowerShdll)
  * [Ben0xA/nps - Not PowerShell](https://github.com/Ben0xA/nps)
  * [bitsadmin/nopowershell - PowerShell rebuilt in C# for Red Teaming purposes](https://github.com/bitsadmin/nopowershell)
  * [Cn33liz/CScriptShell - a Powershell Host running within cscript.exe](https://github.com/Cn33liz/CScriptShell)
  * [leechristensen/UnmanagedPowerShell - Executes PowerShell from an unmanaged process](https://github.com/leechristensen/UnmanagedPowerShell)
  * [Cn33liz/p0wnedLoader - 远程加载加密的 p0wnedShell，使用反射机制](https://github.com/Cn33liz/p0wnedLoader)
  * [mgeeky/Stracciatella - OpSec-safe Powershell runspace from within C# (aka SharpPick) with AMSI and Script Block Logging disabled](https://github.com/mgeeky/Stracciatella)
  * [OmerYa/Invisi-Shell - Hide your Powershell script in plain sight. Bypass all Powershell security features](https://github.com/OmerYa/Invisi-Shell)
  * [decoder-it/powershellveryless - Constrained Language Mode + AMSI bypass all in one](https://github.com/decoder-it/powershellveryless)
  * [PowerTools/PowerPick - Various ways of executing Powershell functionality without the use of Powershell](https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerPick)
  * [Mr-Un1k0d3r/PowerLessShell - Run PowerShell command without invoking powershell.exe](https://github.com/Mr-Un1k0d3r/PowerLessShell)
* WMI
  * [0xbadjuju/WheresMyImplant - A Bring Your Own Land Toolkit that Doubles as a WMI Provider](https://github.com/0xbadjuju/WheresMyImplant)
* Applocker
  * [api0cradle/UltimateAppLockerByPassList - The goal of this repository is to document the most common techniques to bypass AppLocker](https://github.com/api0cradle/UltimateAppLockerByPassList)
  * [freshness79/unlock - Microsoft Applocker evasion tool](https://github.com/freshness79/unlock)
  * [cyberark/Evasor - an automated security assessment tool which locates existing executables on the Windows operating system that can be used to bypass any Application Control rules](https://github.com/cyberark/Evasor)
* [api0cradle/LOLBAS - Living Off The Land Binaries And Scripts - (LOLBins and LOLScripts)](https://github.com/api0cradle/LOLBAS)
  * [LOLBAS-Project/LOLBAS](https://github.com/LOLBAS-Project/LOLBAS)
  * [Living Off The Land Binaries and Scripts (and also Libraries)](https://lolbas-project.github.io/)

白加黑

* [marpie/signed-loaders - signed-loaders documents Windows executables that can be used for side-loading DLLs](https://github.com/marpie/signed-loaders)
* [bohops.com - Exploring the WDAC Microsoft Recommended Block Rules: VisualUiaVerifyNative - 很多有签名的 .NET 程序，会使用 BinaryFormatter 反序列化，可以用来执行任意操作](https://bohops.com/2020/10/15/exploring-the-wdac-microsoft-recommended-block-rules-visualuiaverifynative/)

Credential guard

* [antonioCoco/MalSeclogon - A little tool to play with the Seclogon service - 利用泄露的handle实现lsass DUMP](https://github.com/antonioCoco/MalSeclogon)
* [gitjdm/dumper2020 - Yet another LSASS dumper](https://github.com/gitjdm/dumper2020)
* [Barbarisch/forkatz - credential dump using foreshaw technique using SeTrustedCredmanAccessPrivilege](https://github.com/Barbarisch/forkatz)
* [Iansus/SilentLsassDump](https://github.com/Iansus/SilentLsassDump)
* [Adepts-Of-0xCC/SnoopyOwl](https://github.com/Adepts-Of-0xCC/SnoopyOwl)
  * [A physical graffiti of LSASS: getting credentials from physical memory for fun and learning](https://adepts.of0x.cc/physical-graffiti-lsass/)
* [itm4n/PPLdump - Dump the memory of a PPL with a userland exploit - 绕过PPL进程保护，注入DLL实现minidump](https://github.com/itm4n/PPLdump)
* [teamhydra: Bypassing Credential Guard - 内存修改 lsass wdigest!g_IsCredGuardEnabled 和 wdigest!g_fParameter_useLogonCredential](https://teamhydra.blog/2020/08/25/bypassing-credential-guard/)
* [jfmaes/SharpHandler - 使用已有的lsass handle来读取内存](https://github.com/jfmaes/SharpHandler)
* [b4rtik/SharpMiniDump - Create a minidump of the LSASS process from memory - pinvoke + syscall方式，更加隐蔽](https://github.com/b4rtik/SharpMiniDump)
  * [PorLaCola25/TransactedSharpMiniDump - using NTFS transactions to avoid writting the minidump to disk and exfiltrating it via HTTPS using sockets](https://github.com/PorLaCola25/TransactedSharpMiniDump)
* [deepinstinct/LsassSilentProcessExit - Command line interface to dump LSASS memory to disk via SilentProcessExit - 调用RtlReportSilentProcessExit函数，使WerSvc服务立即为指定的PID生成MiniDump，比直接调用MiniDump更加隐蔽](https://github.com/deepinstinct/LsassSilentProcessExit)
* [CCob/MirrorDump - Another LSASS dumping tool that uses a dynamically compiled LSA plugin to grab an lsass handle and API hooking for capturing the dump in memory](https://github.com/CCob/MirrorDump)
* [Do You Really Know About LSA Protection (RunAsPPL) - 主要参考PS_PROTECTED_SIGNER枚举，以及哪些程序可以打开PPL保护的进程](https://itm4n.github.io/lsass-runasppl/)

AMSI

* [gist: mattifestation/AMSIScriptContentRetrieval.ps1 - PoC code used to demonstrate extracting script contents using the AMSI ETW provider](https://gist.github.com/mattifestation/e179218d88b5f100b0edecdec453d9be)
* [countercept/AMSIDetection - AMSI detection PoC - 检测AMSI绕过的POC，对比硬盘上的amsi.dll与内存加载的版本section hash是否一致来实现的](https://github.com/countercept/AMSIDetection)
* [tokyoneon/Chimera - a (shiny and very hack-ish) PowerShell obfuscation script designed to bypass AMSI and commercial antivirus solutions](https://github.com/tokyoneon/Chimera)
* [didierstevens.com: New Tool: amsiscan.py](https://blog.didierstevens.com/2019/06/13/new-tool-amsiscan-py/)
* [spectorops: Antimalware Scan Interface Detection Optics Analysis Methodology: Identification and Analysis of AMSI for WMI - 通过amsi.dll关键词，枚举使用AMSI的EXE；通过ETW发现WinRM在产生 Microsoft-Antimalware-Scan-Interface 事件；逆向 JAmsiIsScannerNeeded 发现WMI有一套CRC白名单机制](https://posts.specterops.io/antimalware-scan-interface-detection-optics-analysis-methodology-858c37c38383)
* [RythmStick/AMSITrigger - The Hunt for Malicious Strings - pinvoke 调用 AmsiScanBuffer，定位特征码；他是按照4KB切割后，分段检测的，与实际检测结果不一定一致](https://github.com/RythmStick/AMSITrigger)
* [atxsinn3r/amsiscanner - A C/C++ implementation of Microsoft's Antimalware Scan Interface](https://github.com/atxsinn3r/amsiscanner)
* [cobbr/PSAmsi - a tool for auditing and defeating AMSI signatures](https://github.com/cobbr/PSAmsi)

Attack surface reduction - ASR

* [Bypass Windows Defender Attack Surface Reduction - 使用WMI、计划任务、COM、自定义PsExec服务名字实现绕过](https://github.com/sevagas/WindowsDefender_ASR_Bypass-OffensiveCon2019/blob/master/Bypass_Windows_Defender_ASR.pptx)

Signature identification

* [hegusung/AVSignSeek - Tool written in python3 to determine where the AV signature is located in a binary/payload](https://github.com/hegusung/AVSignSeek)
* [utds3lab/multiverse - A static binary rewriter that does not use heuristics](https://github.com/utds3lab/multiverse)
* [matterpreter/DefenderCheck - Identifies the bytes that Microsoft Defender flags on - 特征码识别](https://github.com/matterpreter/DefenderCheck)
* [rasta-mouse/ThreatCheck - Identifies the bytes that Microsoft Defender / AMSI Consumer flags on](https://github.com/rasta-mouse/ThreatCheck)

Linux

* [tokyoneon/Armor - Armor is a simple Bash script designed to create encrypted macOS payloads capable of evading antivirus scanners](https://github.com/tokyoneon/Armor)
* [Bashfuscator - A fully configurable and extendable Bash obfuscation framework](https://github.com/Bashfuscator/Bashfuscator)

VBScript/VBA

* [DoctorLai/VBScript_Obfuscator - The VBScript Obfuscator written in VBScript](https://github.com/DoctorLai/VBScript_Obfuscator)
* [mwrlabs/wePWNise - generates architecture independent VBA code to be used in Office documents or templates and automates bypassing application control and exploit mitigation software](https://github.com/mwrlabs/wePWNise)
* [itm4n/VBA-RunPE - A VBA implementation of the RunPE technique or how to bypass application whitelisting](https://github.com/itm4n/VBA-RunPE)

HTA

* [nccgroup/demiguise - HTA encryption tool](https://github.com/nccgroup/demiguise)

Traffic analysis evasion

* [1tayH/noisy - A simple python script that generates random HTTP/DNS traffic noise in the background while you go about your regular web browsing, to make your web traffic data less valuable for selling and for extra obscurity](https://github.com/1tayH/noisy)
* [xpn/appproxyc2 - This repo contains a simple POC to show how to tunnel traffic through Azure Application Proxy](https://github.com/xpn/appproxyc2)
* [rvrsh3ll/FindFrontableDomains - Search for potential frontable domains](https://github.com/rvrsh3ll/FindFrontableDomains)
* [redteam-cyberark/Google-Domain-fronting - Domain fronting using Google app engine](https://github.com/redteam-cyberark/Google-Domain-fronting)
* [vysec/DomainFrontingLists - A list of Domain Frontable Domains by CDN](https://github.com/vysec/DomainFrontingLists)
* [al0ne/Nmap_Bypass_IDS - nmap绕过IDS的各种技巧](https://github.com/al0ne/Nmap_Bypass_IDS)
* [kirillwow/ids_bypass - IDS Bypass tricks](https://github.com/kirillwow/ids_bypass)
* [Evading Microsoft ATA - 2017年的很老了，需要重测，仅作为参考](http://www.labofapenetrationtester.com/2017/08/week-of-evading-microsoft-ata-day1.html)

Sandbox/cloud based detection evasion

* [violentlydave/mkhtaccess_red - Auto-generate an HTaccess for payload delivery -- automatically pulls ips/nets/etc from known sandbox companies/sources that have been seen before, and redirects them to a benign payload](https://github.com/violentlydave/mkhtaccess_red)
* [David-Reguera-Garcia-Dreg/anticuckoo - A tool to detect and crash Cuckoo Sandbox](https://github.com/David-Reguera-Garcia-Dreg/anticuckoo)
* [a0rtega/pafish - a demonstration tool that employs several techniques to detect sandboxes and analysis environments in the same way as malware families do](https://github.com/a0rtega/pafish)
* [LordNoteworthy/al-khaser - Public malware techniques used in the wild: Virtual Machine, Emulation, Debuggers, Sandbox detection](https://github.com/LordNoteworthy/al-khaser)
* [AlicanAkyol/sems - Virtualbox, VirtualMachine, Cuckoo, Anubis, ThreatExpert, Sandboxie, QEMU, Analysis Tools Detection Tools](https://github.com/AlicanAkyol/sems)
* [Arvanaghi/CheckPlease - Sandbox evasion modules written in PowerShell, Python, Go, Ruby, C, C#, Perl, and Rust](https://github.com/Arvanaghi/CheckPlease)
* [sharepub/CheckVM-Sandbox](https://github.com/sharepub/CheckVM-Sandbox)
* [fr0gger/RocProtect-V1 - Emulating Virtual Environment to stay protected against advanced malware](https://github.com/fr0gger/RocProtect-V1)
* [G4lB1t/SmoothCriminal - Detect sandbox by cursor movement speed - cuckoo的鼠标模拟是固定的，不够随机](https://github.com/G4lB1t/SmoothCriminal)
* [CheckPointSW/InviZzzible - a tool for assessment of your virtual environments in an easy and reliable way. It contains the most recent and up to date detection and evasion techniques as well as fixes for them](https://github.com/CheckPointSW/InviZzzible)
* [LloydLabs/wsb-detect - enables you to detect if you are running in Windows Sandbox ("WSB")](https://github.com/LloydLabs/wsb-detect)
* [ZanderChang/anti-sandbox - Windows对抗沙箱和虚拟机的方法总结](https://github.com/ZanderChang/anti-sandbox)
* 常见思路 - 如果读取注册表、检查沙箱、执行 ping 实现延迟、GetTickCount，会被杀软标记为可疑行为
  * 检查文件名长度是否为32或者包含`.md5.exe`
  * 桌面上的图标数量
  * 使用 GetForegroundWindow + Sleep 检查用户是否切换过窗口且数量大于3
  * 若 `py saz pcap chls` 之一存在文件关联，判断为沙箱环境
  * 使用 GetMonitorInfoA 检查分辨率是否高于 800x600（360有物理机无效）
  * 检查日期，只在周三启动
  * [Summary of recent Anti-Sandbox Tricks - 检查声卡 DirectShow 的案例](http://blog.joesecurity.org/2016/06/summary-of-recent-anti-sandbox-tricks.html)
  * [Analyzing Azorult's Anti-Analysis Tricks with Joe Sandbox Hypervisor - 这个是规则检测](https://www.joesecurity.org/blog/9048980422564630717)

Steganography 隐写术

* [Und3rf10w/boblobblob - hiding git blobs in plain sight](https://github.com/Und3rf10w/boblobblob)
* [peewpw/Invoke-PSImage - Embeds a PowerShell script in the pixels of a PNG file and generates a oneliner to execute](https://github.com/peewpw/Invoke-PSImage)
* [DominicBreuker/stego-toolkit - Collection of steganography tools - helps with CTF challenges](https://github.com/DominicBreuker/stego-toolkit)
* [Under the hood: Hiding data in JPEG images](https://blog.nviso.eu/2020/07/13/how-to-embed-secret-data-in-jpeg-files/)

Uncategorized

* [Tylous/ZipExec - A unique technique to execute binaries from a password protected zip](https://github.com/Tylous/ZipExec)
* [OsandaMalith/PE2HTML - Injects HTML/PHP/ASP to the PE](https://github.com/OsandaMalith/PE2HTML)
* [gh0stkey/avList - 杀软进程对应杀软名称 - 列表质量很差，还有一些病毒的名字，而且还区分大小写，有重复项目](https://github.com/gh0stkey/avList)
* [Allocated filter altitudes - 可用来做驱动黑名单](https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/allocated-altitudes)
* [Malware researchers - Beware of GetProcAddress spoofing via manipulation of PE format in memory - 就是修改IAT，小trick没啥用](https://dennisbabkin.com/blog/?t=malware-researchers-beware-of-getprocaddress-spoofing)

## Resources

* [Unprotect Project](https://search.unprotect.it/map)
* [Anti-Virus, No Thanks - Mark Baggett - 很老的免杀技术了，仅供参考](https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1493863710.pdf)
* [Bypass Windows Defender Attack Surface Reduction - 2019年的，未测试 - ASR目前不拦截计划任务、自定义COM组件；使用 type 命令重写文件绕过 Zone Identifier；...](https://blog.sevagas.com/IMG/pdf/bypass_windows_defender_attack_surface_reduction.pdf)
* [xcon2016: 用深入解析AV虚拟机&高级Bypass技术](http://www.vxjump.net/files/seccon/BAVE_xcon2016.pdf)
* [A Guide to Reversing and Evading EDRs: Part 1](http://jackson-t.ca/edr-reversing-evading-01.html)
* [Thread and Process State Change - Win10 20.04新增API NtCreateProcessStateChange](https://windows-internals.com/thread-and-process-state-change/)
* [Operators, EDR Sensors, and OODA Loops](http://jackson-t.ca/ooda-loops.html)
  * [A Guide to Reversing and Evading EDRs: Part 1](http://jackson-t.ca/edr-reversing-evading-01.html)

