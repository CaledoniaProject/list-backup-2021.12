# Lateral movements

## Collections

Uncategorized

* [klezVirus/CheeseTools - Self-developed tools for Lateral Movement/Code Execution - 都是基础工具，DCOM/RDP/MSSQL CLR](https://github.com/klezVirus/CheeseTools)
* [tasox/LogRM - LogRM is a post exploitation powershell script which it uses windows event logs to gather information about internal network](https://github.com/tasox/LogRM)
* [maaaaz/impacket-examples-windows - The great impacket example scripts compiled for Windows](https://github.com/maaaaz/impacket-examples-windows)
  * [blog: Remote NTLM relaying through meterpreter on Windows port 445 - ntmlrelayx 可以跟 proxychains 一起用: 一边监听转发过来的端口，一边走socks5给受害者发请求](https://diablohorn.com/2018/08/25/remote-ntlm-relaying-through-meterpreter-on-windows-port-445/)
* [securifera/serviceFu - Automates credential skimming from service accounts in Windows Registry，远程注册表 + SC](https://github.com/securifera/serviceFu)
* [pentestpartners: Abusing RDP’s Remote Credential Guard with Rubeus PTT - 本机用ksetup设置DC地址，本地ptt后走代理连接。方案不如impacket简单，仅作为参考](https://www.pentestpartners.com/security-blog/abusing-rdps-remote-credential-guard-with-rubeus-ptt/)

GPO

* [whitel1st/GP_Hijack - Group Policy Hijacking](https://github.com/whitel1st/GP_Hijack)
* [mwrlabs/SharpGPOAbuse - take advantage of a user's edit rights on a Group Policy Object (GPO) in order to compromise the objects that are controlled by that GPO](https://github.com/mwrlabs/SharpGPOAbuse)
* [l0ss/Grouper - A PowerShell script for helping to find vulnerable settings in AD Group Policy - 很有用的离线组策略分析工具，列出定时任务、MSI下发、防火墙设置等等](https://github.com/l0ss/Grouper)
  * [Get-GPTrashFire - 介绍功能的PPT](https://github.com/l0ss/Get-GPTrashfire/blob/master/Get-GPTrashFire.pdf)

WMI / WinRM

* [RiccardoAncarani/LiquidSnake - a tool that allows operators to perform fileless lateral movement using WMI Event Subscriptions and GadgetToJScript - WMI远程执行，类型选vbscript](https://github.com/RiccardoAncarani/LiquidSnake)
* [FortyNorthSecurity/CIMplant - C# port of WMImplant which uses either CIM or WMI to query remote systems](https://github.com/FortyNorthSecurity/CIMplant)
* [secabstraction/WmiSploit - a small set of PowerShell scripts that leverage the WMI service, for post-exploitation use](https://github.com/secabstraction/WmiSploit)
* [bohops/WSMan-WinRM - A collection of proof-of-concept source code and scripts for executing remote commands over WinRM using the WSMan.Automation COM object](https://github.com/bohops/WSMan-WinRM)
* [cube0x0/SharpMapExec - A sharpen version of CrackMapExec](https://github.com/cube0x0/SharpMapExec)
* [360-Linton-Lab/WMIHACKER - A Bypass Anti-virus Software Lateral Movement Command Execution Tool](https://github.com/360-Linton-Lab/WMIHACKER)
* [mez-0/CSharpWinRM - .NET 4.0 WinRM API Command Execution](https://github.com/mez-0/CSharpWinRM)
* [0xthirteen/SharpMove - 这个更全面一些，DCOM/WMI执行vbs/远程计划任务/远程修改现有服务/远程注册表改COM](https://github.com/0xthirteen/SharpMove)
* [Hackplayers/evil-winrm - The ultimate WinRM shell for hacking/pentesting](https://github.com/Hackplayers/evil-winrm)
* [Cybereason/Invoke-WMILM - a PoC script for various methods to acheive authenticated remote code execution via WMI, without (at least directly) using the Win32_Process class](https://github.com/Cybereason/Invoke-WMILM)
* [xorrior/RemoteRecon - provides the ability to execute post-exploitation capabilities against a remote host, without having to expose your complete toolkit/agent - 2017停更，用的 DotNetToJscript + WMI](https://github.com/xorrior/RemoteRecon)
* [hitb2018ams: No Win32_Process Needed - 就讲了一个WMI class继承，绕过检测的思路](https://conference.hitb.org/hitbsecconf2018ams/materials/D2T1%20-%20Philip%20Tsukerman%20-%20Expanding%20Your%20WMI%20Lateral%20Movement%20Arsenal.pdf)
* [checkymander/Sharp-InvokeWMIExec - A native C# conversion of Kevin Robertsons Invoke-WMIExec powershell script.](https://github.com/checkymander/Sharp-InvokeWMIExec/)
* [packer-community/winrmcp - Copy files to a remote host using WinRM](https://github.com/packer-community/winrmcp)
* [FortyNorthSecurity/WMIOps - a powershell script which uses WMI for various purposes across a network](https://github.com/FortyNorthSecurity/WMIOps)
* [QAX-A-Team/sharpwmi - sharpwmi是一个基于rpc的横向移动工具，具有上传文件和执行命令功能 - 包含 WMI StdRegProv csharp 调用例子](https://github.com/QAX-A-Team/sharpwmi)
* [rchaganti/CimUtils - Set of CIM utilities that can be used to make it easy to work with CIM classes](https://github.com/rchaganti/CimUtils)
* [FortyNorthSecurity/WMImplant - a PowerShell based tool that is designed to act like a RAT](https://github.com/FortyNorthSecurity/WMImplant)

WebDAV

* [xforcered/GetWebDAVStatus - Determine if the WebClient Service (WebDAV) is running on a remote system - 尝试访问远程 \pipe\DAV RPC SERVICE 管道来判断](https://github.com/xforcered/GetWebDAVStatus)

LDAP

* [SecuProject/ADenum - AD Enum is a pentesting tool that allows to find misconfiguration through the the protocol LDAP and exploit some of those weaknesses with kerberos](https://github.com/SecuProject/ADenum)
* [p0dalirius/LDAPmonitor - Monitor creation, deletion and changes to LDAP objects live during your pentest or system administration](https://github.com/p0dalirius/LDAPmonitor)
* [ropnop/windapsearch - Python script to enumerate users, groups and computers from a Windows domain through LDAP queries](https://github.com/ropnop/windapsearch)
* [shellster/LDAPPER - AD LDAP Command Line Searching that doesn't suck](https://github.com/shellster/LDAPPER)
* [stufus/ADOffline - Imports an LDAP file from Active Directory for SQL based offline reconnisance](https://github.com/stufus/ADOffline)
* [kgoins/ldsview - Offline search tool for LDAP directory dumps in LDIF format](https://github.com/kgoins/ldsview)

SMB

* [p0dalirius/FindUncommonShares - FindUncommonShares.py is a Python equivalent of PowerView's Invoke-ShareFinder.ps1](https://github.com/p0dalirius/FindUncommonShares)
* [S3cur3Th1sSh1t/NamedPipePTH - Pass the Hash to a named pipe for token Impersonation](https://github.com/S3cur3Th1sSh1t/NamedPipePTH)
  * [S3cur3Th1sSh1t/SharpNamedPipePTH - Pass the Hash to a named pipe for token Impersonation](https://github.com/S3cur3Th1sSh1t/SharpNamedPipePTH)
* [anthemtotheego/SharpExec - PSExec/WMIExec 实现](https://github.com/anthemtotheego/SharpExec)
* [portcullislabs/enum4linux - a Linux alternative to enum.exe for enumerating data from Windows and Samba hosts - 需要开启NULL Session才能利用，用处不大了](https://github.com/portcullislabs/enum4linux)
* [ShawnDEvans/smbmap - SMBMap is a handy SMB enumeration tool - 不要测试域控，sysvol默认可写不可删除](https://github.com/ShawnDEvans/smbmap)
* [kavika13/RemCom - Remote Command Executor: A OSS replacement for PsExec and RunAs - or Telnet without having to install a server](https://github.com/kavika13/RemCom)
* [shirosaidev/sharesniffer - Network share sniffer and auto-mounter for crawling remote file systems](https://github.com/shirosaidev/sharesniffer)
* [Mr-Un1k0d3r/SCShell - 使用 LogonUser + ChangeServiceConfigA 远程修改服务，并执行命令](https://github.com/Mr-Un1k0d3r/SCShell)
* [poweradminllc/PAExec - Remote execution, like PsExec - 2017停更](https://github.com/poweradminllc/PAExec)
* [juliourena/SharpNoPSExec - Get file less command execution for lateral movement - 随机挑选一个禁用的SYSTEM服务，执行完命令后还原](https://github.com/juliourena/SharpNoPSExec)

DCOM

* [cube0x0/SharpSystemTriggers - Collection of remote authentication triggers in C# - DCOM/EFSRPC/Spooler三种远程认证触发工具](https://github.com/cube0x0/SharpSystemTriggers)
* [r35tart/GetIPinfo - 用于寻找多网卡主机方便内网跨网段渗透避免瞎打找不到核心网 - 使用impacket调用ObjectExporter::ServerAlive2接口获取IP信息](https://github.com/r35tart/GetIPinfo)
* [Haboob Team: Abusing COM & DCOM objects](https://dl.packetstormsecurity.net/papers/general/abusing-objects.pdf)
* [ScorpionesLabs/DVS - D(COM) V(ulnerability) S(canner) AKA Devious swiss army knife - Lateral movement using DCOM Objects](https://github.com/ScorpionesLabs/DVS)
* [codewhitesec/LethalHTA - Lateral Movement technique using DCOM and HTA](https://github.com/codewhitesec/LethalHTA)
* [hausec/COMMethodSearcher - Script that searches through all COM objects for any methods containing a key word of your choosing](https://github.com/hausec/COMMethodSearcher)
* [sud0woodo/DCOMrade - Powershell script for enumerating vulnerable DCOM Applications](https://github.com/sud0woodo/DCOMrade)
* [outflanknl/Excel4-DCOM - PowerShell and Cobalt Strike scripts for lateral movement using Excel 4.0 / XLM macros via DCOM (direct shellcode injection in Excel.exe)](https://github.com/outflanknl/Excel4-DCOM)
  * [rvrsh3ll/SharpExcel4-DCOM - Port of Invoke-Excel4DCOM](https://github.com/rvrsh3ll/SharpExcel4-DCOM)

Kerberos

* [ShutdownRepo/targetedKerberoast - Kerberoast with ACL abuse capabilities](https://github.com/ShutdownRepo/targetedKerberoast)
* [rvazarkar/KrbCredExport - Exports Kerberos KrbCred Tickets for use in Mimikatz/Beacon from a Kerberos CCache File](https://github.com/rvazarkar/KrbCredExport)
* [machosec/Mystique - PowerShell module to play with Kerberos S4U extensions](https://github.com/machosec/Mystique)
* [gentilkiwi/kekeo - A little toolbox to play with Microsoft Kerberos in C](https://github.com/gentilkiwi/kekeo)
* [ropnop/kerbrute - A tool to perform Kerberos pre-auth bruteforcing - AD默认不记录4771失败日志，而且这个爆破更快](https://github.com/ropnop/kerbrute)
* [Zer1t0/ticket_converter - A little tool to convert ccache tickets into kirbi (KRB-CRED) and vice versa based on impacket](https://github.com/Zer1t0/ticket_converter)
* [pkb1s/SharpAllowedToAct - Computer object takeover through Resource-Based Constrained Delegation (msDS-AllowedToActOnBehalfOfOtherIdentity)](https://github.com/pkb1s/SharpAllowedToAct)
* [Ridter/SharpAddDomainMachine - The same script as SharpAllowedToAct, but more usefully for local privilege escalation](https://github.com/Ridter/SharpAddDomainMachine)
* [the-useless-one/pywerview - A (partial) Python rewriting of PowerSploit's PowerView](https://github.com/the-useless-one/pywerview)
* [tevora-threat/SharpView - C# implementation of harmj0y's PowerView](https://github.com/tevora-threat/SharpView)
* [nidem/kerberoast - 这个是纯手动利用方案，只保留做参考](https://github.com/nidem/kerberoast)
  * [EmpireProject/Empire - data/module_source/credentials/Invoke-Kerberoast.ps1 - harmj0y 实现的，已经被 Rubeus 取代](https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1)
* [skelsec/kerberoast - Kerberoast attack -pure python-](https://github.com/skelsec/kerberoast)
* [GhostPack/Rubeus - Trying to tame the three-headed dog](https://github.com/GhostPack/Rubeus/)
* [cyberark/RiskySPN - Detect and abuse risky SPNs](https://github.com/cyberark/RiskySPN)
* [ccache2john.py - ccache也可以爆破](https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/run/ccache2john.py)
* [dirkjanm/krbrelayx - Kerberos unconstrained delegation abuse toolkit](https://github.com/dirkjanm/krbrelayx)
  * [Relaying Kerberos - Having fun with unconstrained delegation](https://dirkjanm.io/krbrelayx-unconstrained-delegation-abuse-toolkit/)
* [3gstudent/pyKerbrute - Use python to perform Kerberos pre-auth bruteforcing](https://github.com/3gstudent/pyKerbrute)
* [redsiege.com: Kerberos & Attacks 101](https://www.redsiege.com/wp-content/uploads/2020/04/20200430-kerb101.pdf)
* [tothi/rbcd-attack - Kerberos Resource-Based Constrained Delegation Attack from Outside using Impacket - 机器账号可以修改自己的delegation权限，所以做个假机器账号，然后CIFS上去执行命令](https://github.com/tothi/rbcd-attack)

PTH
 
* [byt3bl33d3r/pth-toolkit - Modified version of the passing-the-hash tool collection (https://code.google.com/p/passing-the-hash/) made to work straight out of the box](https://github.com/byt3bl33d3r/pth-toolkit)
* [Kevin-Robertson/Invoke-TheHash - PowerShell Pass The Hash Utils](https://github.com/Kevin-Robertson/Invoke-TheHash)
* [mkellerman/Invoke-CommandAs - Invoke Command as System/User on Local/Remote computer using ScheduleTask](https://github.com/mkellerman/Invoke-CommandAs)

Printer

* [Universal Privilege Escalation and Persistence – Printer - 使用mimispool的代码例子创建恶意打印机驱动](https://pentestlab.blog/2021/08/02/universal-privilege-escalation-and-persistence-printer/)
  * [gentilkiwi/mimikatz - mimispool - 这里也有PS命令，跟上面应该一样的](https://github.com/gentilkiwi/mimikatz/tree/master/mimispool)
* [jacob-baines/concealed_position - Bring your own print driver privilege escalation tool](https://github.com/jacob-baines/concealed_position)
* [vletoux/SpoolerScanner - Check if MS-RPRN is remotely available with powershell/c#](https://github.com/vletoux/SpoolerScanner)
* [BusesCanFly/PRETty - "PRinter Exploitation Toolkit" LAN automation tool](https://github.com/BusesCanFly/PRETty)
* [syscall.e: Attacking Xerox multi function printers](https://syscall.eu/pdf/INFILTRATE2020-RIGO-Xerox-final.pdf)

Uncategorized

* [cube0x0/SharpSystemTriggers - Collection of remote authentication triggers in C# - 支持MS-EFS/MS-RPRN两个协议](https://github.com/cube0x0/SharpSystemTriggers)

## Resources

* [shenaniganslabs.io: Wagging the Dog: Abusing Resource-Based Constrained Delegation to Attack Active Directory](https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html)
* [Kerberos Survival Guide](https://social.technet.microsoft.com/wiki/contents/articles/4209.kerberos-survival-guide.aspx)
* [Another Word on Delegation - 在ADSI里给计算机账号增加写权限，之后使用文中的脚本增加msDS-AllowedToDelegateTo设置，然后使用S4U+CIFS控制目标设备 - 假想场景，实战中较为罕见](https://www.harmj0y.net/blog/redteaming/another-word-on-delegation)
* [Understanding Windows Lateral Movements - 目前关于Windows本地和远程认证讲的最清晰的PDF](https://attl4s.github.io/assets/pdf/Understanding_Windows_Lateral_Movements.pdf)
* [Resetting Expired Passwords Remotely](https://www.n00py.io/2021/09/resetting-expired-passwords-remotely/)
* [Lateral Movement - Windows and Active Directory](https://riccardoancarani.github.io/2019-10-04-lateral-movement-megaprimer/)
