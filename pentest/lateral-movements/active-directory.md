## Active Directory

3rd-party lists

* [S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet - A cheat sheet that contains common enumeration and attack methods for Windows Active Directory](https://github.com/S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet)
* [Windows & Active Directory Exploitation Cheat Sheet and Command Reference](https://casvancooten.com/posts/2020/11/windows-active-directory-exploitation-cheat-sheet-and-command-reference/)
* [RedTeamWing/Hunting-Active-Directory - 个人整理的一些域渗透Tricks，可能有一些错误](https://github.com/RedTeamWing/Hunting-Active-Directory)
* [Attacking Active Directory: 0 to 0.9](https://zer1t0.gitlab.io/posts/attacking_ad/)

Uncategorized

* [Mr-Un1k0d3r/ADHuntTool - official report for the AdHuntTool. C# Script used for Red Team. It can be used by Cobalt Strike execute-assembly or as standalone executable](https://github.com/Mr-Un1k0d3r/ADHuntTool)
* [edemilliere/ADSI - Active Directory Searcher helper - Invoke-ADSDPropagation可以立即刷新SDProp配置](https://github.com/edemilliere/ADSI)
* [incredibleindishell/Windows-AD-environment-related - This Repository contains the stuff related to windows Active directory environment exploitation - 除了利用工具，还包含一个AD基础加固方案](https://github.com/incredibleindishell/Windows-AD-environment-related)
* [p0dalirius/pydsinternals - A Python native library containing necessary classes, functions and structures to interact with Windows Active Directory](https://github.com/p0dalirius/pydsinternals)
* [ShutdownRepo/pywhisker - Python version of the C# tool for "Shadow Credentials" attacks](https://github.com/ShutdownRepo/pywhisker)
* [lkarlslund/adalanche - Active Directory ACL Visualizer - who's really Domain Admin](https://github.com/lkarlslund/adalanche)
* [microsoft/azureadexporter - PowerShell module to export a local copy of all Azure Active Directory configuration settings and objects](https://github.com/microsoft/azureadexporter)
* [joeware: Command line Active Directory query tool](http://www.joeware.net/freetools/tools/adfind/)
* [xforcered/StandIn - StandIn is a small .NET35/45 AD post-exploitation toolkit](https://github.com/xforcered/StandIn)
* [Gerenios/AADInternals - AADInternals PowerShell module for administering Azure AD and Office 365](https://github.com/Gerenios/AADInternals)
  * [AAD Internals 官方用法介绍](https://o365blog.com/aadinternals/#install-aadintptaspy)
* [ANSSI-FR/AD-control-paths - Active Directory Control Paths auditing and graphing tools](https://github.com/ANSSI-FR/AD-control-paths)
* [NetSPI/goddi - goddi (go dump domain info) dumps Active Directory domain information](https://github.com/NetSPI/goddi)
* [sid-500 编写的各种PowerShell脚本](https://sid-500.com/downloads/)
* [k8gege/k8getPC - Using SMB/Browser Get Lan PC Name & OSversion](https://github.com/k8gege/k8getPC)
* [sensepost/UserEnum - Domain user enumeration tool](https://github.com/sensepost/UserEnum)
* [dev-2null/ADCollector - A lightweight tool to quickly extract valuable information from the Active Directory environment for both attacking and defending](https://github.com/dev-2null/ADCollector)
* [phillips321/adaudit - Powershell script to do domain auditing automation](https://github.com/phillips321/adaudit)
* [sense-of-security/ADRecon - a tool which gathers information about the Active Directory and generates a report which can provide a holistic picture of the current state of the target AD environment](https://github.com/sense-of-security/ADRecon)
* [sixdub/DomainTrustExplorer - Python script for analyis of the "Trust.csv" file generated by Veil PowerView. Provides graph based analysis and output - 结合 Invoke-MapDomainTrusts 一起使用](https://github.com/sixdub/DomainTrustExplorer)
* [DanMcInerney/icebreaker - Gets plaintext Active Directory credentials if you're on the internal network but outside the AD environment](https://github.com/DanMcInerney/icebreaker)
* [Tylous/Vibe - A framework for stealthy domain reconnaissance](https://github.com/Tylous/Vibe)
* [skorov/ridrelay - Enumerate usernames on a domain where you have no creds by using SMB Relay with low priv - 钓鱼成功会自动通过SMB查询账号](https://github.com/skorov/ridrelay)
* [Greenwolf/ntlm_theft - A tool for generating multiple types of NTLMv2 hash theft files by Jacob Wilkin (Greenwolf)](https://github.com/Greenwolf/ntlm_theft)
* [leoloobeek/LAPSToolkit - Tool to audit and attack LAPS environments](https://github.com/leoloobeek/LAPSToolkit)
* [vletoux/MakeMeEnterpriseAdmin - 用金钥匙可以把 Domain Admins 提权到 Enterprise Admins，这个对mimikatz没有依赖](https://github.com/vletoux/MakeMeEnterpriseAdmin)
* [samratashok/ADModule - Microsoft signed ActiveDirectory PowerShell module (windows 2016里面复制出来的，有签名，可以绕过CLM限制)](https://github.com/samratashok/ADModule)
* [lazywinadmin/AdsiPS - PowerShell module to interact with Active Directory using ADSI and the System.DirectoryServices namespace (.NET Framework)](https://github.com/lazywinadmin/AdsiPS)
* [russelltomkins/Active-Directory - Collection of scripts for Querying and Managing Active Directory and Domain Controllers - 包含一些账号查询脚本，比如密码不过期的、开启了kerberos delegation的账号](https://github.com/russelltomkins/Active-Directory)
* [SecureThisShit/WinPwn - Automation for internal Windows Penetrationtest / AD-Security - Still much work to do](https://github.com/SecureThisShit/WinPwn)
* [aas-n/spraykatz - A tool to spray love around the world](https://github.com/aas-n/spraykatz)
* [davidprowe/BadBlood - fills a Microsoft Active Directory Domain with a structure and thousands of objects](https://github.com/davidprowe/BadBlood)

Privilege escalation

* [gdedrouas/Exchange-AD-Privesc - Exchange privilege escalations to Active Directory](https://github.com/gdedrouas/Exchange-AD-Privesc)
* [hausec/ADAPE-Script - Active Directory Assessment and Privilege Escalation Script](https://github.com/hausec/ADAPE-Script)
* [fox-it/Invoke-ACLPwn - a tool that automates the discovery and pwnage of ACLs in Active Directory that are unsafe configured](https://github.com/fox-it/Invoke-ACLPwn)

Relay

* [nccgroup/Change-Lockscreen - Offensive tool to trigger network authentications as SYSTEM](https://github.com/nccgroup/Change-Lockscreen)
* [AlteredSecurity/AzureADJoinedMachinePTC - A tool to execute Pass-The-Certificate attack for lateral movement between Azure AD joined machines](https://github.com/AlteredSecurity/AzureADJoinedMachinePTC)
* [leechristensen/SpoolSample - PoC tool to coerce Windows hosts authenticate to other machines via the MS-RPRN RPC interface](https://github.com/leechristensen/SpoolSample)
  * [Hunting in Active Directory: Unconstrained Delegation & Forests Trusts - 这有个打印机的说明](https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1)
* [Arno0x/NtlmRelayToEWS - ntlm relay attack to Exchange Web Services](https://github.com/Arno0x/NtlmRelayToEWS)
* [pkb1s/SharpRelay - 用WinDiver改端口来接受smb数据，用socks5实现凭证发送，有点麻烦](https://github.com/pkb1s/SharpRelay)
* [CCob/lsarelayx - NTLM relaying for Windows made easy - 似乎是lsass插件，风险很高](https://github.com/CCob/lsarelayx)

Authentication

* [topotam/PetitPotam - coerce Windows hosts to authenticate to other machines via MS-EFSRPC EfsRpcOpenFileRaw function](https://github.com/topotam/PetitPotam)
* [vletoux/NTLMInjector - In case you didn't now how to restore the user password after a password reset (get the previous hash with DCSync) - 直接设置NTLM密码，用于恢复现场的](https://github.com/vletoux/NTLMInjector)
* [eladshamir/Internal-Monologue - Internal Monologue Attack: Retrieving NTLM Hashes without Touching LSASS](https://github.com/eladshamir/Internal-Monologue)
* [3gstudent: 通过CredSSP获取明文密码，也不需要读取lsass](https://github.com/3gstudent/3gstudent.github.io/blob/47cdaae15d36b78cc34761662a1471dff0223050/_posts/2020-8-6-%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7%E2%80%94%E2%80%94%E9%80%9A%E8%BF%87CredSSP%E5%AF%BC%E5%87%BA%E7%94%A8%E6%88%B7%E7%9A%84%E6%98%8E%E6%96%87%E5%8F%A3%E4%BB%A4.md)

Mimikatz

* [skelsec/pypykatz - Mimikatz implementation in pure Python - 这个支持在线和离线模式，还实现了handledup功能](https://github.com/skelsec/pypykatz)
* [Flangvik/BetterSafetyKatz - modified fork of SafetyKatz dynamically fetches the latest pre-compiled release of Mimikatz directly from the gentilkiwi GitHub repo, runtime patching on detected signatures and uses @subtee's PE Loader to get it into memory](https://github.com/Flangvik/BetterSafetyKatz)
* [STEALTHbits/poshkatz - PowerShell module for Mimikatz](https://github.com/STEALTHbits/poshkatz)
* [b4rtik/SharpKatz - Porting of mimikatz sekurlsa::logonpasswords, sekurlsa::ekeys and lsadump::dcsync commands](https://github.com/b4rtik/SharpKatz)

AD CS

* [ly4k/Certipy - Python implementation for Active Directory certificate abuse](https://github.com/ly4k/Certipy)
* [GhostPack/Certify - Active Directory certificate abuse](https://github.com/GhostPack/Certify)
* [GhostPack/PSPKIAudit - PowerShell toolkit for AD CS auditing based on the PSPKI toolkit](https://github.com/GhostPack/PSPKIAudit)
* [GhostPack/ForgeCert - use a stolen Certificate Authority (CA) certificate + private key to forge certificates for arbitrary users capable of authentication to Active Directory - 有个PDF: Certified Pre-Owned](https://github.com/GhostPack/ForgeCert)

AD IDNS

* [Kevin-Robertson/Powermad - PowerShell MachineAccountQuota and DNS exploit tools - AD-DNS工具、机器账号增删工具。普通用户默认就有权限，只是有配额限制](https://github.com/Kevin-Robertson/Powermad)
  * [MachineAccountQuota is USEFUL Sometimes: Exploiting One of Active Directory’s Oddest Settings - 对于非DA账号，机器账号创建后无法删除；机器账号可以不带$，甚至以空格结尾](https://blog.netspi.com/machineaccountquota-is-useful-sometimes/)
* [dirkjanm/adidnsdump - Active Directory Integrated DNS dumping by any authenticated user](https://github.com/dirkjanm/adidnsdump)
* [b4rtik/SharpAdidnsdump - c# implementation of Active Directory Integrated DNS dumping (authenticated user)](https://github.com/b4rtik/SharpAdidnsdump)
* [kurtfalde/DNS-Debug - Script to enabled DNS Debug Logging across Domain Controllers in a Forest and then retrieve for analysis](https://github.com/kurtfalde/DNS-Debug)

DSC

* [matthastings/DSCompromised - PowerShell framework for managing and infecting systems via Windows Desired State Configuration (DSC) - 需要Windows 2012以上系统](https://github.com/matthastings/DSCompromised)
* [specterops: Abusing PowerShell Desired State Configuration for Lateral Movement](https://posts.specterops.io/abusing-powershell-desired-state-configuration-for-lateral-movement-ca42ddbe6f06)  

## Resources

* [从 mimikatz 学习 Windows 安全之访问控制模型（二）](https://paper.seebug.org/1672/)
* [googleprojectzero: Using Kerberos for Authentication Relay Attacks](https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html)
